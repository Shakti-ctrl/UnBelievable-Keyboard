package juloo.keyboard2;

import android.content.Context;
import android.content.SharedPreferences;
import org.json.JSONObject;
import org.json.JSONArray;
import java.util.Map;
import java.util.HashSet;
import java.util.Set;
import java.util.Iterator;

public class DefaultSettingsApplier {
    private static final String DEFAULT_JSON = "{\"settings\":{\"extra_key_combining_caron\":false,\"longpress_interval\":12,\"extra_key_combining_shaddah\":false,\"margin_bottom_portrait_unfolded\":7,\"extra_key_page_up\":true,\"key_horizontal_margin\":2,\"extra_key_cut\":true,\"circle_sensitivity\":\"2\",\"extra_key_capslock\":true,\"extra_key_combining_fatha\":false,\"layouts\":\"[\\\\\\\"{\\\\\\\\\\\\\\\"kind\\\\\\\\\\\\\\\":\\\\\\\\\\\\\\\"system\\\\\\\\\\\\\\\"}\\\\\\\"]\",\"extra_key_†\":false,\"key_activated_opacity\":100,\"extra_key_combining_grave\":false,\"extra_key_accent_trema\":false,\"extra_key_nbsp\":false,\"extra_key_accent_breve\":false,\"number_entry_layout\":\"pin\",\"keyboard_opacity\":100,\"border_config\":false,\"extra_key_combining_sukun\":false,\"extra_key_delete_word\":false,\"extra_key_combining_hamza_above\":false,\"character_size\":1.15,\"extra_key_combining_kasratan\":false,\"extra_key_accent_double_grave\":false,\"extra_key_accent_slash\":false,\"extra_key_combining_double_aigu\":false,\"custom_border_line_width\":0,\"extra_key_combining_horn\":false,\"version\":3,\"swipe_dist\":\"15\",\"extra_key_switch_greekmath\":false,\"extra_key_combining_payerok\":false,\"extra_key_switch_clipboard\":true,\"extra_key_accent_tilde\":false,\"keyboard_height_landscape\":50,\"keyboard_height_unfolded\":35,\"extra_key_accent_dot_above\":false,\"extra_key_combining_inverted_breve\":false,\"extra_key_combining_ogonek\":false,\"lock_double_tap\":true,\"extra_key_shareText\":true,\"extra_key_combining_slavonic_psili\":false,\"extra_key_combining_vzmet\":false,\"number_row\":\"no_number_row\",\"extra_key_combining_titlo\":false,\"keyboard_height\":26,\"extra_key_compose\":true,\"extra_key_undo\":true,\"extra_key_scroll_lock\":true,\"extra_key_accent_cedille\":false,\"extra_key_ß\":false,\"extra_key_accent_grave\":false,\"horizontal_margin_portrait\":3,\"extra_key_esc\":true,\"extra_key_combining_tilde\":false,\"margin_bottom_portrait\":7,\"extra_key_page_down\":true,\"theme\":\"jungle\",\"extra_key_home\":false,\"extra_key_accent_hook_above\":false,\"extra_key_accent_horn\":false,\"extra_key_combining_cedille\":false,\"extra_key_meta\":false,\"slider_sensitivity\":\"30\",\"extra_key_combining_breve\":false,\"vibrate_duration\":20,\"extra_key_ctrl\":true,\"extra_key_f12\":false,\"extra_key_f11\":false,\"extra_key_combining_diaeresis\":false,\"extra_key_f10\":false,\"extra_key_tab\":true,\"extra_key_delete\":true,\"extra_key_combining_ring_above\":false,\"extra_key_accent_caron\":false,\"custom_border_radius\":0,\"extra_key_combining_dot_below\":false,\"extra_key_f9\":false,\"extra_key_f8\":false,\"extra_key_f7\":false,\"extra_key_f6\":false,\"extra_key_f5\":false,\"extra_key_f4\":false,\"extra_key_f3\":false,\"extra_key_f2\":false,\"extra_key_f1\":false,\"extra_key_accent_dot_below\":false,\"extra_key_switch_voice_typing\":true,\"extra_key_combining_dot_above\":false,\"label_brightness\":100,\"extra_key_combining_left_half_ring_above\":false,\"extra_key_altgr\":true,\"extra_key_combining_macron\":false,\"extra_key_combining_commatized\":false,\"extra_key_accent_double_aigu\":false,\"extra_key_combining_double_grave\":false,\"extra_key_accent_macron\":false,\"extra_key_combining_kamora\":false,\"extra_key_accent_ring\":false,\"key_vertical_margin\":1.5,\"extra_key_combining_diaeresis_below\":false,\"key_opacity\":100,\"margin_bottom_landscape\":3,\"extra_key_copy\":true,\"extra_key_combining_hamza_below\":false,\"extra_key_combining_iota_subscript\":false,\"extra_key_accent_aigu\":false,\"extra_key_combining_acute\":false,\"extra_key_combining_dasi_pneumata\":false,\"extra_key_combining_hook_above\":false,\"extra_key_combining_dasi_oxeia\":false,\"extra_key_combining_psili_pneumata\":false,\"extra_key_combining_psili_oxeia\":false,\"extra_key_accent_ordinal\":false,\"extra_key_accent_circonflexe\":false,\"extra_key_combining_kavyka\":false,\"extra_key_combining_psili_vareia\":false,\"extra_key_combining_dasi_vareia\":false,\"extra_key_combining_perispomeni\":false,\"extra_key_alt\":true,\"vibrate_custom\":false,\"extra_key_accent_ogonek\":false,\"extra_key_combining_dammatan\":false,\"extra_key_combining_kasra\":false,\"extra_key_combining_fathatan\":false,\"extra_key_combining_damma\":false,\"longpress_timeout\":600,\"extra_key_end\":false,\"extra_key_paste\":true,\"extra_key_selectAll\":true,\"margin_bottom_landscape_unfolded\":3,\"extra_key_accent_arrows\":false,\"extra_key_insert\":true,\"extra_key_combining_shadda\":false,\"extra_key_accent_box\":false,\"extra_key_combining_caron_above\":false,\"extra_key_left\":true,\"extra_key_down\":true,\"horizontal_margin_landscape\":28,\"extra_key_up\":true,\"extra_key_right\":true,\"extra_key_accent_bar\":false,\"extra_key_switch_text\":true,\"extra_key_accent_cedilla\":false,\"horizontal_margin_landscape_unfolded\":28,\"extra_key_accent_cedille_bottom\":false,\"extra_key_accent_aigu_left\":false,\"extra_key_accent_aigu_right\":false,\"extra_key_switch_method\":true,\"extra_key_accent_grave_left\":false,\"extra_key_accent_grave_right\":false,\"extra_key_accent_tilde_above\":false,\"extra_key_accent_tilde_below\":false,\"extra_key_accent_circumflex\":false,\"extra_key_accent_inverted_circumflex\":false,\"extra_key_accent_double_circumflex\":false,\"extra_key_accent_caron_above\":false,\"extra_key_accent_caron_below\":false,\"extra_key_accent_breve_above\":false,\"extra_key_accent_breve_below\":false,\"extra_key_accent_macron_above\":false,\"extra_key_accent_macron_below\":false,\"extra_key_accent_overline\":false,\"extra_key_accent_underline\":false,\"extra_key_accent_strikethrough\":false,\"extra_key_accent_double_strikethrough\":false,\"extra_key_accent_dot_above_right\":false,\"extra_key_accent_dot_below_right\":false,\"extra_key_accent_double_dot_above\":false,\"extra_key_accent_double_dot_below\":false,\"extra_key_accent_comma_above\":false,\"extra_key_accent_comma_below\":false,\"extra_key_accent_reversed_comma_above\":false,\"extra_key_accent_reversed_comma_below\":false,\"extra_key_accent_hook\":false,\"extra_key_accent_inverted_hook\":false,\"extra_key_accent_palatal_hook\":false,\"extra_key_accent_retroflex_hook\":false,\"extra_key_accent_horn_above\":false,\"extra_key_accent_horn_below\":false,\"extra_key_accent_tail\":false,\"extra_key_accent_inverted_tail\":false,\"extra_key_accent_bridge_above\":false,\"extra_key_accent_bridge_below\":false,\"extra_key_accent_inverted_bridge_above\":false,\"extra_key_accent_inverted_bridge_below\":false,\"extra_key_accent_square_above\":false,\"extra_key_accent_square_below\":false,\"extra_key_accent_seagull_above\":false,\"extra_key_accent_seagull_below\":false,\"extra_key_accent_x_above\":false,\"extra_key_accent_x_below\":false,\"extra_key_accent_vertical_line_above\":false,\"extra_key_accent_vertical_line_below\":false,\"extra_key_accent_double_vertical_line_above\":false,\"extra_key_accent_double_vertical_line_below\":false,\"extra_key_accent_ring_above\":false,\"extra_key_accent_ring_below\":false,\"extra_key_accent_left_half_ring_above\":false,\"extra_key_accent_left_half_ring_below\":false,\"extra_key_accent_right_half_ring_above\":false,\"extra_key_accent_right_half_ring_below\":false,\"extra_key_accent_left_angle_above\":false,\"extra_key_accent_left_angle_below\":false,\"extra_key_accent_right_angle_above\":false,\"extra_key_accent_right_angle_below\":false,\"extra_key_accent_plus_sign_above\":false,\"extra_key_accent_plus_sign_below\":false,\"extra_key_accent_minus_sign_above\":false,\"extra_key_accent_minus_sign_below\":false,\"extra_key_accent_equals_sign_above\":false,\"extra_key_accent_equals_sign_below\":false,\"extra_key_accent_tilde_left\":false,\"extra_key_accent_tilde_right\":false,\"extra_key_accent_circumflex_left\":false,\"extra_key_accent_circumflex_right\":false,\"extra_key_accent_caron_left\":false,\"extra_key_accent_caron_right\":false,\"extra_key_accent_breve_left\":false,\"extra_key_accent_breve_right\":false,\"extra_key_accent_macron_left\":false,\"extra_key_accent_macron_right\":false,\"extra_key_accent_dot_left\":false,\"extra_key_accent_dot_right\":false,\"extra_key_accent_double_dot_left\":false,\"extra_key_accent_double_dot_right\":false,\"extra_key_accent_comma_left\":false,\"extra_key_accent_comma_right\":false,\"extra_key_accent_reversed_comma_left\":false,\"extra_key_accent_reversed_comma_right\":false,\"extra_key_accent_hook_left\":false,\"extra_key_accent_hook_right\":false,\"extra_key_accent_inverted_hook_left\":false,\"extra_key_accent_inverted_hook_right\":false,\"extra_key_accent_palatal_hook_left\":false,\"extra_key_accent_palatal_hook_right\":false,\"extra_key_accent_retroflex_hook_left\":false,\"extra_key_accent_retroflex_hook_right\":false,\"extra_key_accent_horn_left\":false,\"extra_key_accent_horn_right\":false,\"extra_key_accent_tail_left\":false,\"extra_key_accent_tail_right\":false,\"extra_key_accent_inverted_tail_left\":false,\"extra_key_accent_inverted_tail_right\":false,\"extra_key_accent_bridge_left\":false,\"extra_key_accent_bridge_right\":false,\"extra_key_accent_inverted_bridge_left\":false,\"extra_key_accent_inverted_bridge_right\":false,\"extra_key_accent_square_left\":false,\"extra_key_accent_square_right\":false,\"extra_key_accent_seagull_left\":false,\"extra_key_accent_seagull_right\":false,\"extra_key_accent_x_left\":false,\"extra_key_accent_x_right\":false,\"extra_key_accent_vertical_line_left\":false,\"extra_key_accent_vertical_line_right\":false,\"extra_key_accent_double_vertical_line_left\":false,\"extra_key_accent_double_vertical_line_right\":false,\"extra_key_accent_ring_left\":false,\"extra_key_accent_ring_right\":false,\"extra_key_accent_left_half_ring_left\":false,\"extra_key_accent_left_half_ring_right\":false,\"extra_key_accent_right_half_ring_left\":false,\"extra_key_accent_right_half_ring_right\":false,\"extra_key_accent_left_angle_left\":false,\"extra_key_accent_left_angle_right\":false,\"extra_key_accent_right_angle_left\":false,\"extra_key_accent_right_angle_right\":false,\"extra_key_accent_plus_sign_left\":false,\"extra_key_accent_plus_sign_right\":false,\"extra_key_accent_minus_sign_left\":false,\"extra_key_accent_minus_sign_right\":false,\"extra_key_accent_equals_sign_left\":false,\"extra_key_accent_equals_sign_right\":false,\"keyboard_height_portrait\":26,\"horizontal_margin_portrait_unfolded\":3,\"autocapitalisation\":true,\"switch_input_immediate\":false,\"clipboard_history_enabled\":true,\"clipboard_history_duration\":\"5\"}}";

    public static void apply(Context context) {
        try {
            JSONObject backup = new JSONObject(DEFAULT_JSON);
            JSONObject settingsJson = backup.getJSONObject("settings");
            SharedPreferences prefs = DirectBootAwarePreferences.get_shared_preferences(context);
            SharedPreferences.Editor editor = prefs.edit();
            
            Iterator<String> keys = settingsJson.keys();
            while (keys.hasNext()) {
                String key = keys.next();
                Object value = settingsJson.get(key);
                
                if (value instanceof Boolean) editor.putBoolean(key, (Boolean) value);
                else if (value instanceof Integer) editor.putInt(key, (Integer) value);
                else if (value instanceof Long) editor.putLong(key, (Long) value);
                else if (value instanceof Double) editor.putFloat(key, ((Double) value).floatValue());
                else if (value instanceof String) {
                    String s = (String) value;
                    if (s.startsWith("[") && s.endsWith("]")) {
                        try {
                            JSONArray array = new JSONArray(s);
                            Set<String> set = new HashSet<>();
                            for (int i = 0; i < array.length(); i++) {
                                set.add(array.getString(i));
                            }
                            editor.putStringSet(key, set);
                        } catch (Exception e) {
                            editor.putString(key, s);
                        }
                    } else {
                        editor.putString(key, s);
                    }
                }
            }
            editor.apply();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
